<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.33">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Uzair Ahmed">

<title>Regression Final Project</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Regression_Final_files/libs/clipboard/clipboard.min.js"></script>
<script src="Regression_Final_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="Regression_Final_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="Regression_Final_files/libs/quarto-html/popper.min.js"></script>
<script src="Regression_Final_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Regression_Final_files/libs/quarto-html/anchor.min.js"></script>
<link href="Regression_Final_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Regression_Final_files/libs/quarto-html/quarto-syntax-highlighting-ea385d0e468b0dd5ea5bf0780b1290d9.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Regression_Final_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Regression_Final_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Regression_Final_files/libs/bootstrap/bootstrap-81267100e462c21b3d6c0d5bf76a3417.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Regression Final Project</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Uzair Ahmed </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<p>The goal of this project is to look at various player performance metrics and create a model that best predicts a players strikeout rate. This was done with data during the 2024 MLB season looking at qualified hitters, a sample of 129 players. We looked at SwStr%, OBP, SLG, SB, ZSwing%, OSwing%, Zone% and Position (C, INF, OF, DH).</p>
<section id="importing-and-cleaning-data" class="level2">
<h2 class="anchored" data-anchor-id="importing-and-cleaning-data">Importing and Cleaning Data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(olsrr)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>First we imported all the requisite libraries for this project.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>mlb1 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"/Users/uzairahmed/Downloads/mlb1.csv"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>mlb2 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"/Users/uzairahmed/Downloads/mlb2.csv"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>mlb3 <span class="ot">&lt;-</span> <span class="fu">merge</span>(mlb1, mlb2, <span class="at">by =</span> <span class="st">"Name"</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>mlb3 <span class="ot">&lt;-</span> mlb3 <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">K =</span> K.) </span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>mlb3 <span class="ot">&lt;-</span> mlb3 <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">BB =</span> BB.)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>mlb3 <span class="ot">&lt;-</span> mlb3 <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">OSwing =</span> O.Swing.)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>mlb3 <span class="ot">&lt;-</span> mlb3 <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">ZSwing =</span> Z.Swing.)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>mlb3 <span class="ot">&lt;-</span> mlb3 <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">Contact =</span> Contact.)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>mlb3 <span class="ot">&lt;-</span> mlb3 <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">Zone =</span> Zone.)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>mlb3 <span class="ot">&lt;-</span> mlb3 <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">SwStr =</span> SwStr.)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>mlb3<span class="sc">$</span>BB <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">"%"</span>, <span class="st">""</span>, mlb3<span class="sc">$</span>BB))</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>mlb3<span class="sc">$</span>K  <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">"%"</span>, <span class="st">""</span>, mlb3<span class="sc">$</span>K))</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>mlb3<span class="sc">$</span>OSwing <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">"%"</span>, <span class="st">""</span>, mlb3<span class="sc">$</span>OSwing))</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>mlb3<span class="sc">$</span>ZSwing <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">"%"</span>, <span class="st">""</span>, mlb3<span class="sc">$</span>ZSwing))</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>mlb3<span class="sc">$</span>Contact <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">"%"</span>, <span class="st">""</span>, mlb3<span class="sc">$</span>Contact))</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>mlb3<span class="sc">$</span>Zone <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">"%"</span>, <span class="st">""</span>, mlb3<span class="sc">$</span>Zone))</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>mlb3<span class="sc">$</span>SwStr <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">"%"</span>, <span class="st">""</span>, mlb3<span class="sc">$</span>SwStr))</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>mlb3 <span class="ot">&lt;-</span> mlb3 <span class="sc">%&gt;%</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">BB =</span> BB <span class="sc">/</span> <span class="dv">100</span>,</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">K =</span> K <span class="sc">/</span> <span class="dv">100</span>,</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">OSwing =</span> OSwing <span class="sc">/</span> <span class="dv">100</span>,</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">ZSwing =</span> ZSwing <span class="sc">/</span> <span class="dv">100</span>,</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">Contact =</span> Contact <span class="sc">/</span> <span class="dv">100</span>,</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">Zone =</span> Zone <span class="sc">/</span> <span class="dv">100</span>,</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">SwStr =</span> SwStr <span class="sc">/</span> <span class="dv">100</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, we imported the data into R. The data was exported from fangraphs into an excel sheet which was then imported into R. MLB1 contained the base performance stats we were planning on using while MLB2 contained the plate discipline stats we were using. We renamed and converted the variables to ensure a functional data set. To keep all our variables aligned as decimals we converted the factors that were listed as percents into decimals.</p>
</section>
<section id="statistical-summaries" class="level2">
<h2 class="anchored" data-anchor-id="statistical-summaries">Statistical Summaries</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mlb3, <span class="fu">aes</span>(<span class="at">x=</span>K)) <span class="sc">+</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth=</span><span class="fl">0.01</span>, <span class="at">fill=</span><span class="st">"skyblue"</span>, <span class="at">color=</span><span class="st">"black"</span>, <span class="at">alpha=</span><span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"MLB Player SO% 2024"</span>, <span class="at">x=</span><span class="st">"SO%"</span>, <span class="at">y=</span><span class="st">"Frequency"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Regression_Final_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mlb3<span class="sc">$</span>K)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.0430  0.1700  0.2110  0.2106  0.2510  0.3440 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mlb3, <span class="fu">aes</span>(<span class="at">x=</span>SB)) <span class="sc">+</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth=</span><span class="dv">3</span>, <span class="at">fill=</span><span class="st">"skyblue"</span>, <span class="at">color=</span><span class="st">"black"</span>, <span class="at">alpha=</span><span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"MLB Player Stolen Bases 2024"</span>, <span class="at">x=</span><span class="st">"SB"</span>, <span class="at">y=</span><span class="st">"Frequency"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Regression_Final_files/figure-html/unnamed-chunk-3-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mlb3<span class="sc">$</span>SB)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   0.00    3.00    9.00   12.74   19.00   67.00 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mlb3, <span class="fu">aes</span>(<span class="at">x=</span>OBP)) <span class="sc">+</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth=</span><span class="fl">0.01</span>, <span class="at">fill=</span><span class="st">"skyblue"</span>, <span class="at">color=</span><span class="st">"black"</span>, <span class="at">alpha=</span><span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"MLB Player OBP 2024"</span>, <span class="at">x=</span><span class="st">"OBP"</span>, <span class="at">y=</span><span class="st">"Frequency"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Regression_Final_files/figure-html/unnamed-chunk-3-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mlb3<span class="sc">$</span>OBP)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.2700  0.3120  0.3250  0.3288  0.3420  0.4580 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mlb3, <span class="fu">aes</span>(<span class="at">x=</span>SLG)) <span class="sc">+</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth=</span><span class="fl">0.02</span>, <span class="at">fill=</span><span class="st">"skyblue"</span>, <span class="at">color=</span><span class="st">"black"</span>, <span class="at">alpha=</span><span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"MLB Player SLG% 2024"</span>, <span class="at">x=</span><span class="st">"SLG"</span>, <span class="at">y=</span><span class="st">"Frequency"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Regression_Final_files/figure-html/unnamed-chunk-3-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mlb3<span class="sc">$</span>SLG)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.3310  0.3940  0.4280  0.4359  0.4640  0.7010 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mlb3, <span class="fu">aes</span>(<span class="at">x=</span>OSwing)) <span class="sc">+</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth=</span><span class="fl">0.01</span>, <span class="at">fill=</span><span class="st">"skyblue"</span>, <span class="at">color=</span><span class="st">"black"</span>, <span class="at">alpha=</span><span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"MLB Player OSwing% 2024"</span>, <span class="at">x=</span><span class="st">"OSwing%"</span>, <span class="at">y=</span><span class="st">"Frequency"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Regression_Final_files/figure-html/unnamed-chunk-3-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mlb3<span class="sc">$</span>OSwing)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  0.213   0.277   0.312   0.316   0.348   0.495 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mlb3, <span class="fu">aes</span>(<span class="at">x=</span>ZSwing)) <span class="sc">+</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth=</span><span class="fl">0.01</span>, <span class="at">fill=</span><span class="st">"skyblue"</span>, <span class="at">color=</span><span class="st">"black"</span>, <span class="at">alpha=</span><span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"MLB Player ZSwing% 2024"</span>, <span class="at">x=</span><span class="st">"ZSwing%"</span>, <span class="at">y=</span><span class="st">"Frequency"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Regression_Final_files/figure-html/unnamed-chunk-3-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mlb3<span class="sc">$</span>ZSwing)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.5550  0.6630  0.6980  0.7001  0.7450  0.8260 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mlb3, <span class="fu">aes</span>(<span class="at">x=</span>Zone)) <span class="sc">+</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth=</span><span class="fl">0.01</span>, <span class="at">fill=</span><span class="st">"skyblue"</span>, <span class="at">color=</span><span class="st">"black"</span>, <span class="at">alpha=</span><span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"MLB Player Zone% 2024"</span>, <span class="at">x=</span><span class="st">"Zone%"</span>, <span class="at">y=</span><span class="st">"Frequency"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Regression_Final_files/figure-html/unnamed-chunk-3-7.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mlb3<span class="sc">$</span>Zone)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.3640  0.4060  0.4200  0.4198  0.4350  0.4670 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mlb3, <span class="fu">aes</span>(<span class="at">x=</span>SwStr)) <span class="sc">+</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth=</span><span class="fl">0.01</span>, <span class="at">fill=</span><span class="st">"skyblue"</span>, <span class="at">color=</span><span class="st">"black"</span>, <span class="at">alpha=</span><span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"MLB Player SwStr% 2024"</span>, <span class="at">x=</span><span class="st">"SwStr%"</span>, <span class="at">y=</span><span class="st">"Frequency"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Regression_Final_files/figure-html/unnamed-chunk-3-8.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mlb3<span class="sc">$</span>SwStr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.0280  0.0860  0.1050  0.1056  0.1280  0.1920 </code></pre>
</div>
</div>
<p>We looked at a distribution for all our quantitative variables and looked at the 5 number summaries for each.</p>
</section>
<section id="slr-relationships" class="level2">
<h2 class="anchored" data-anchor-id="slr-relationships">SLR Relationships</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(K<span class="sc">~</span>SB, <span class="at">data=</span>mlb3)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = K ~ SB, data = mlb3)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.167427 -0.040481  0.000734  0.039928  0.132713 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 2.099e-01  6.672e-03  31.466   &lt;2e-16 ***
SB          5.376e-05  3.730e-04   0.144    0.886    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.05321 on 127 degrees of freedom
Multiple R-squared:  0.0001636, Adjusted R-squared:  -0.007709 
F-statistic: 0.02078 on 1 and 127 DF,  p-value: 0.8856</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(K<span class="sc">~</span>OBP, <span class="at">data=</span>mlb3)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = K ~ OBP, data = mlb3)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.160799 -0.036683 -0.004333  0.039026  0.109949 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  0.34153    0.05069   6.738 5.03e-10 ***
OBP         -0.39805    0.15351  -2.593   0.0106 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.05186 on 127 degrees of freedom
Multiple R-squared:  0.05028,   Adjusted R-squared:  0.0428 
F-statistic: 6.723 on 1 and 127 DF,  p-value: 0.01063</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>m3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(K<span class="sc">~</span>SLG, <span class="at">data=</span>mlb3)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = K ~ SLG, data = mlb3)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.165440 -0.037881  0.000617  0.039073  0.137055 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  0.18891    0.03335   5.664 9.39e-08 ***
SLG          0.04982    0.07575   0.658    0.512    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.05313 on 127 degrees of freedom
Multiple R-squared:  0.003394,  Adjusted R-squared:  -0.004453 
F-statistic: 0.4325 on 1 and 127 DF,  p-value: 0.512</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>m4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(K<span class="sc">~</span>OSwing, <span class="at">data=</span>mlb3)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = K ~ OSwing, data = mlb3)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.16935 -0.04066 -0.00001  0.04041  0.13298 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  0.20017    0.02742   7.300 2.78e-11 ***
OSwing       0.03310    0.08549   0.387    0.699    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.05319 on 127 degrees of freedom
Multiple R-squared:  0.001179,  Adjusted R-squared:  -0.006685 
F-statistic: 0.1499 on 1 and 127 DF,  p-value: 0.6992</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>m5 <span class="ot">&lt;-</span> <span class="fu">lm</span>(K<span class="sc">~</span>ZSwing, <span class="at">data=</span>mlb3)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = K ~ ZSwing, data = mlb3)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.159452 -0.036157  0.001253  0.039853  0.126446 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)  0.10274    0.05729   1.793   0.0753 .
ZSwing       0.15411    0.08157   1.889   0.0612 .
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.05248 on 127 degrees of freedom
Multiple R-squared:  0.02733,   Adjusted R-squared:  0.01967 
F-statistic: 3.569 on 1 and 127 DF,  p-value: 0.06115</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>m6 <span class="ot">&lt;-</span> <span class="fu">lm</span>(K<span class="sc">~</span>Zone, <span class="at">data=</span>mlb3)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m6)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = K ~ Zone, data = mlb3)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.14839 -0.03825  0.00075  0.03713  0.14681 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   0.4541     0.0933   4.867 3.29e-06 ***
Zone         -0.5799     0.2220  -2.613   0.0101 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.05184 on 127 degrees of freedom
Multiple R-squared:  0.05101,   Adjusted R-squared:  0.04354 
F-statistic: 6.826 on 1 and 127 DF,  p-value: 0.01007</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>m7 <span class="ot">&lt;-</span> <span class="fu">lm</span>(K<span class="sc">~</span>SwStr, <span class="at">data=</span>mlb3)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m7)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = K ~ SwStr, data = mlb3)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.073536 -0.023419 -0.001439  0.020386  0.086721 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  0.08092    0.01057   7.658 4.18e-12 ***
SwStr        1.22815    0.09567  12.838  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.03511 on 127 degrees of freedom
Multiple R-squared:  0.5648,    Adjusted R-squared:  0.5613 
F-statistic: 164.8 on 1 and 127 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>m8 <span class="ot">&lt;-</span> <span class="fu">lm</span>(K<span class="sc">~</span>Position, <span class="at">data=</span>mlb3)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m8)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = K ~ Position, data = mlb3)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.160576 -0.036576 -0.001576  0.041424  0.140424 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  0.222889   0.017639  12.636   &lt;2e-16 ***
PositionDH   0.011111   0.025714   0.432    0.666    
PositionINF -0.019313   0.018804  -1.027    0.306    
PositionOF  -0.008606   0.019288  -0.446    0.656    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.05292 on 125 degrees of freedom
Multiple R-squared:  0.02675,   Adjusted R-squared:  0.003389 
F-statistic: 1.145 on 3 and 125 DF,  p-value: 0.3336</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mlb3, <span class="fu">aes</span>(<span class="at">x =</span> OBP, <span class="at">y =</span> K)) <span class="sc">+</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Strikeout Rate vs OBP"</span>, <span class="at">x =</span> <span class="st">"OBP"</span>, <span class="at">y =</span> <span class="st">"SO Rate"</span>) <span class="sc">+</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Regression_Final_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mlb3, <span class="fu">aes</span>(<span class="at">x =</span> Zone, <span class="at">y =</span> K)) <span class="sc">+</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Strikeout Rate vs Zone%"</span>, <span class="at">x =</span> <span class="st">"Zone%"</span>, <span class="at">y =</span> <span class="st">"SO Rate"</span>) <span class="sc">+</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Regression_Final_files/figure-html/unnamed-chunk-5-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mlb3, <span class="fu">aes</span>(<span class="at">x =</span> SwStr, <span class="at">y =</span> K)) <span class="sc">+</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Strikeout Rate vs SwStr%"</span>, <span class="at">x =</span> <span class="st">"SwStr%"</span>, <span class="at">y =</span> <span class="st">"SO Rate"</span>) <span class="sc">+</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Regression_Final_files/figure-html/unnamed-chunk-5-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Looking at the SLR relationships only 3 predictors were significant at the 0.05 level so I graphed them vs the response variables to visualize the relationships even further.</p>
</section>
<section id="mlr-relationships" class="level2">
<h2 class="anchored" data-anchor-id="mlr-relationships">MLR Relationships</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>mlb_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(K <span class="sc">~</span> SB <span class="sc">+</span> OBP <span class="sc">+</span> SLG <span class="sc">+</span> OSwing <span class="sc">+</span> ZSwing <span class="sc">+</span> Zone <span class="sc">+</span> SwStr <span class="sc">+</span> Position, <span class="at">data =</span> mlb3)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mlb_fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = K ~ SB + OBP + SLG + OSwing + ZSwing + Zone + SwStr + 
    Position, data = mlb3)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.05178 -0.01204  0.00101  0.01124  0.04846 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  0.5115141  0.0724435   7.061 1.23e-10 ***
SB          -0.0001609  0.0001550  -1.038 0.301181    
OBP         -0.4056790  0.1129152  -3.593 0.000478 ***
SLG          0.0911770  0.0508453   1.793 0.075498 .  
OSwing      -0.4339857  0.0496577  -8.740 1.88e-14 ***
ZSwing      -0.3874189  0.0492467  -7.867 1.93e-12 ***
Zone         0.0003865  0.1148862   0.003 0.997321    
SwStr        1.9513585  0.0872662  22.361  &lt; 2e-16 ***
PositionDH  -0.0064275  0.0104396  -0.616 0.539291    
PositionINF -0.0014255  0.0076081  -0.187 0.851691    
PositionOF  -0.0054177  0.0078485  -0.690 0.491364    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.0202 on 118 degrees of freedom
Multiple R-squared:  0.8661,    Adjusted R-squared:  0.8547 
F-statistic: 76.31 on 10 and 118 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_vif_tol</span>(mlb_fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Variables Tolerance      VIF
1           SB 0.8350579 1.197522
2          OBP 0.2805324 3.564650
3          SLG 0.3210244 3.115028
4       OSwing 0.4277256 2.337948
5       ZSwing 0.4066127 2.459343
6         Zone 0.5669584 1.763798
7        SwStr 0.3980385 2.512320
8   PositionDH 0.4991441 2.003429
9  PositionINF 0.2187935 4.570520
10  PositionOF 0.2239077 4.466126</code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_step_best_subset</span>(mlb_fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  Best Subsets Regression                  
-----------------------------------------------------------
Model Index    Predictors
-----------------------------------------------------------
     1         SwStr                                        
     2         ZSwing SwStr                                 
     3         OSwing ZSwing SwStr                          
     4         OBP OSwing ZSwing SwStr                      
     5         OBP SLG OSwing ZSwing SwStr                  
     6         OBP SLG OSwing ZSwing SwStr Position         
     7         SB OBP SLG OSwing ZSwing SwStr Position      
     8         SB OBP SLG OSwing ZSwing Zone SwStr Position 
-----------------------------------------------------------

                                                     Subsets Regression Summary                                                      
-------------------------------------------------------------------------------------------------------------------------------------
                       Adj.        Pred                                                                                               
Model    R-Square    R-Square    R-Square      C(p)         AIC          SBIC          SBC        MSEP      FPE       HSP       APC  
-------------------------------------------------------------------------------------------------------------------------------------
  1        0.5648      0.5613      0.5512    258.4648    -494.0578     -863.6790    -485.4783    0.1590    0.0013    0.0000    0.4489 
  2        0.7553      0.7514      0.7439     92.6366    -566.3171     -935.1367    -554.8778    0.0901     7e-04    0.0000    0.2564 
  3        0.8420      0.8382       0.833     18.1958    -620.7821     -987.4649    -606.4830    0.0586     5e-04    0.0000    0.1681 
  4        0.8597      0.8551      0.8491      4.6568    -634.0519     -999.7097    -616.8930    0.0525     4e-04    0.0000    0.1517 
  5        0.8629      0.8573      0.8505      3.7785    -635.0901    -1000.3687    -615.0714    0.0517     4e-04    0.0000    0.1505 
  6        0.8648      0.8558      0.8459      8.1007    -630.8946     -999.8310    -602.2965    0.0514     4e-04    0.0000    0.1507 
  7        0.8661      0.8559      0.8445      9.0000    -630.0924     -998.7044    -598.6345    0.0514     4e-04    0.0000    0.1516 
  8        0.8661      0.8547      0.8419     11.0000    -628.0924     -996.5180    -593.7747    0.0518     4e-04    0.0000    0.1540 
-------------------------------------------------------------------------------------------------------------------------------------
AIC: Akaike Information Criteria 
 SBIC: Sawa's Bayesian Information Criteria 
 SBC: Schwarz Bayesian Criteria 
 MSEP: Estimated error of prediction, assuming multivariate normality 
 FPE: Final Prediction Error 
 HSP: Hocking's Sp 
 APC: Amemiya Prediction Criteria </code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>mlb_optimal <span class="ot">&lt;-</span> <span class="fu">lm</span>(K <span class="sc">~</span> OBP <span class="sc">+</span> SLG <span class="sc">+</span> OSwing <span class="sc">+</span> ZSwing <span class="sc">+</span> SwStr, <span class="at">data =</span> mlb3)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mlb_optimal)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = K ~ OBP + SLG + OSwing + ZSwing + SwStr, data = mlb3)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.048428 -0.012604  0.000046  0.011887  0.046971 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  0.49915    0.03595  13.883  &lt; 2e-16 ***
OBP         -0.40686    0.10805  -3.766 0.000256 ***
SLG          0.08556    0.04998   1.712 0.089399 .  
OSwing      -0.43031    0.04402  -9.776  &lt; 2e-16 ***
ZSwing      -0.37099    0.04581  -8.099  4.6e-13 ***
SwStr        1.92849    0.07911  24.378  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.02002 on 123 degrees of freedom
Multiple R-squared:  0.8629,    Adjusted R-squared:  0.8573 
F-statistic: 154.9 on 5 and 123 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_vif_tol</span>(mlb_optimal)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Variables Tolerance      VIF
1       OBP 0.3008411 3.324014
2       SLG 0.3262930 3.064730
3    OSwing 0.5345588 1.870702
4    ZSwing 0.4615111 2.166795
5     SwStr 0.4756285 2.102481</code></pre>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">scatter.smooth</span>(mlb_optimal<span class="sc">$</span>fitted.values, mlb_optimal<span class="sc">$</span>residuals,</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">"Residuals vs Fitted"</span>,</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"Fitted Values"</span>, <span class="at">ylab=</span><span class="st">"Residuals"</span>)</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Regression_Final_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(mlb_optimal<span class="sc">$</span>residuals)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(mlb_optimal<span class="sc">$</span>residuals, <span class="at">col =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Regression_Final_files/figure-html/unnamed-chunk-6-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mlb_optimal))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mlb_optimal)
W = 0.99417, p-value = 0.8773</code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(mlb_optimal)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    studentized Breusch-Pagan test

data:  mlb_optimal
BP = 7.4765, df = 5, p-value = 0.1875</code></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>MSE <span class="ot">&lt;-</span> <span class="fu">summary</span>(mlb_optimal)<span class="sc">$</span>sigma<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>outlier_check <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">data.frame</span>(<span class="at">Residuals=</span>mlb_optimal<span class="sc">$</span>residuals,</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"Standardized Res"</span><span class="ot">=</span>mlb_optimal<span class="sc">$</span>residuals<span class="sc">/</span><span class="fu">sqrt</span>(MSE),</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"Studentized Res"</span><span class="ot">=</span><span class="fu">rstandard</span>(mlb_optimal),</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"Press"</span><span class="ot">=</span><span class="fu">rstandard</span>(mlb_optimal,<span class="at">type=</span><span class="st">'predictive'</span>),</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"R-student"</span><span class="ot">=</span><span class="fu">rstudent</span>(mlb_optimal),</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"Hat-Values"</span><span class="ot">=</span><span class="fu">hatvalues</span>(mlb_optimal)),<span class="dv">2</span>)</span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a><span class="co">#outlier_check</span></span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>influence <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">data.frame</span>(<span class="at">Cooks=</span><span class="fu">cooks.distance</span>(mlb_optimal),</span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a>                              <span class="at">dffits=</span><span class="fu">dffits</span>(mlb_optimal),</span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a>                              <span class="at">dfbeta=</span><span class="fu">dfbetas</span>(mlb_optimal),</span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a>                              <span class="at">cov_ratio=</span><span class="fu">covratio</span>(mlb_optimal)),<span class="dv">3</span>)</span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a><span class="co">#influence</span></span>
<span id="cb65-16"><a href="#cb65-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-17"><a href="#cb65-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-18"><a href="#cb65-18" aria-hidden="true" tabindex="-1"></a>mlb_3 <span class="ot">&lt;-</span> mlb3 <span class="sc">%&gt;%</span> </span>
<span id="cb65-19"><a href="#cb65-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Cooks =</span> <span class="fu">cooks.distance</span>(mlb_optimal)) <span class="sc">%&gt;%</span> </span>
<span id="cb65-20"><a href="#cb65-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">StuRes =</span> <span class="fu">rstandard</span>(mlb_optimal)) <span class="sc">%&gt;%</span> </span>
<span id="cb65-21"><a href="#cb65-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dffits =</span> <span class="fu">dffits</span>(mlb_optimal)) <span class="sc">%&gt;%</span> </span>
<span id="cb65-22"><a href="#cb65-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">covratio =</span> <span class="fu">covratio</span>(mlb_optimal))</span>
<span id="cb65-23"><a href="#cb65-23" aria-hidden="true" tabindex="-1"></a><span class="co">#mlb_3</span></span>
<span id="cb65-24"><a href="#cb65-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-25"><a href="#cb65-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-26"><a href="#cb65-26" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(mlb_3, <span class="fu">abs</span>(StuRes) <span class="sc">&gt;</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               Name HR SB    BB     K   AVG   OBP   SLG  WAR Position OSwing
1    Carlos Santana 23  4 0.109 0.167 0.238 0.328 0.420  3.0      INF  0.270
2 Christopher Morel 21  8 0.100 0.260 0.196 0.288 0.346 -1.0      INF  0.297
3         Juan Soto 41  7 0.181 0.167 0.288 0.419 0.569  8.1       OF  0.213
4     Michael Busch 21  2 0.111 0.286 0.248 0.335 0.440  2.3      INF  0.274
5      Mookie Betts 19 16 0.118 0.110 0.289 0.372 0.491  4.4       OF  0.229
6      Seiya Suzuki 21 16 0.108 0.274 0.283 0.366 0.482  3.6       OF  0.236
  ZSwing Contact  Zone SwStr      Cooks    StuRes     dffits  covratio
1  0.667   0.787 0.412 0.092 0.01440188 -2.436427 -0.3000916 0.7918695
2  0.719   0.684 0.410 0.148 0.05261083 -2.189317 -0.5707839 0.8818551
3  0.601   0.799 0.402 0.074 0.07717007 -2.026086 -0.6892841 0.9533154
4  0.710   0.745 0.404 0.115 0.01721517  2.271403  0.3270119 0.8283663
5  0.654   0.861 0.410 0.056 0.04176453 -2.380587 -0.5104458 0.8263205
6  0.627   0.777 0.410 0.088 0.03618640  2.390269  0.4752301 0.8194639</code></pre>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(mlb_3, Cooks <span class="sc">&gt;</span> <span class="fl">0.031</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   Name HR SB    BB     K   AVG   OBP   SLG  WAR Position
1     Anthony Santander 44  2 0.087 0.194 0.235 0.308 0.506  3.3       OF
2     Christopher Morel 21  8 0.100 0.260 0.196 0.288 0.346 -1.0      INF
3       George Springer 19 16 0.098 0.187 0.220 0.303 0.371  1.2       OF
4             Juan Soto 41  7 0.181 0.167 0.288 0.419 0.569  8.1       OF
5          Mookie Betts 19 16 0.118 0.110 0.289 0.372 0.491  4.4       OF
6          Rhys Hoskins 26  3 0.103 0.288 0.214 0.303 0.419  0.1      INF
7          Seiya Suzuki 21 16 0.108 0.274 0.283 0.366 0.482  3.6       OF
8 Vladimir Guerrero Jr. 30  2 0.103 0.138 0.323 0.396 0.544  5.4      INF
  OSwing ZSwing Contact  Zone SwStr      Cooks    StuRes     dffits  covratio
1  0.375  0.688   0.822 0.392 0.088 0.03242748  1.257791  0.4421511 1.0912195
2  0.297  0.719   0.684 0.410 0.148 0.05261083 -2.189317 -0.5707839 0.8818551
3  0.284  0.753   0.769 0.440 0.113 0.03234752 -1.896058 -0.4453125 0.9264256
4  0.213  0.601   0.799 0.402 0.074 0.07717007 -2.026086 -0.6892841 0.9533154
5  0.229  0.654   0.861 0.410 0.056 0.04176453 -2.380587 -0.5104458 0.8263205
6  0.281  0.615   0.771 0.439 0.098 0.03188314  1.865198  0.4418897 0.9327265
7  0.236  0.627   0.777 0.410 0.088 0.03618640  2.390269  0.4752301 0.8194639
8  0.306  0.710   0.801 0.430 0.096 0.03198945 -1.879266 -0.4427234 0.9296988</code></pre>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(mlb_3, Cooks <span class="sc">&gt;</span> <span class="fl">0.031</span> <span class="sc">&amp;</span> <span class="fu">abs</span>(dffits) <span class="sc">&gt;</span> (<span class="dv">2</span><span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">5</span><span class="sc">/</span><span class="dv">129</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   Name HR SB    BB     K   AVG   OBP   SLG  WAR Position
1     Anthony Santander 44  2 0.087 0.194 0.235 0.308 0.506  3.3       OF
2     Christopher Morel 21  8 0.100 0.260 0.196 0.288 0.346 -1.0      INF
3       George Springer 19 16 0.098 0.187 0.220 0.303 0.371  1.2       OF
4             Juan Soto 41  7 0.181 0.167 0.288 0.419 0.569  8.1       OF
5          Mookie Betts 19 16 0.118 0.110 0.289 0.372 0.491  4.4       OF
6          Rhys Hoskins 26  3 0.103 0.288 0.214 0.303 0.419  0.1      INF
7          Seiya Suzuki 21 16 0.108 0.274 0.283 0.366 0.482  3.6       OF
8 Vladimir Guerrero Jr. 30  2 0.103 0.138 0.323 0.396 0.544  5.4      INF
  OSwing ZSwing Contact  Zone SwStr      Cooks    StuRes     dffits  covratio
1  0.375  0.688   0.822 0.392 0.088 0.03242748  1.257791  0.4421511 1.0912195
2  0.297  0.719   0.684 0.410 0.148 0.05261083 -2.189317 -0.5707839 0.8818551
3  0.284  0.753   0.769 0.440 0.113 0.03234752 -1.896058 -0.4453125 0.9264256
4  0.213  0.601   0.799 0.402 0.074 0.07717007 -2.026086 -0.6892841 0.9533154
5  0.229  0.654   0.861 0.410 0.056 0.04176453 -2.380587 -0.5104458 0.8263205
6  0.281  0.615   0.771 0.439 0.098 0.03188314  1.865198  0.4418897 0.9327265
7  0.236  0.627   0.777 0.410 0.088 0.03618640  2.390269  0.4752301 0.8194639
8  0.306  0.710   0.801 0.430 0.096 0.03198945 -1.879266 -0.4427234 0.9296988</code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(mlb_3, covratio <span class="sc">&gt;</span> (<span class="dv">1</span> <span class="sc">+</span> (<span class="dv">15</span><span class="sc">/</span><span class="dv">129</span>)) <span class="sc">|</span> covratio <span class="sc">&lt;</span> (<span class="dv">1</span> <span class="sc">-</span> (<span class="dv">15</span><span class="sc">/</span><span class="dv">129</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 Name HR SB    BB     K   AVG   OBP   SLG  WAR Position OSwing
1         Aaron Judge 58 10 0.189 0.243 0.322 0.458 0.701 11.2       OF  0.213
2        Alex Bregman 26  3 0.069 0.136 0.260 0.315 0.453  4.2      INF  0.265
3      Bobby Witt Jr. 32 31 0.080 0.150 0.332 0.389 0.588 10.4      INF  0.354
4      Carlos Santana 23  4 0.109 0.167 0.238 0.328 0.420  3.0      INF  0.270
5    Ceddanne Rafaela 15 19 0.026 0.264 0.246 0.274 0.390  0.9       OF  0.495
6   Christopher Morel 21  8 0.100 0.260 0.196 0.288 0.346 -1.0      INF  0.297
7        Corey Seager 30  1 0.099 0.180 0.278 0.353 0.512  4.6      INF  0.317
8     Elly De La Cruz 25 67 0.099 0.313 0.259 0.339 0.471  6.4      INF  0.297
9      Ezequiel Tovar 26  6 0.033 0.288 0.269 0.295 0.469  3.7      INF  0.481
10        Jake Burger 29  1 0.054 0.259 0.250 0.301 0.460  1.4      INF  0.413
11       Jose Ramirez 39 41 0.079 0.120 0.279 0.335 0.537  6.5      INF  0.348
12     Kyle Schwarber 38  5 0.153 0.285 0.248 0.366 0.485  3.4       DH  0.240
13        Luis Arraez  4  9 0.036 0.043 0.314 0.346 0.392  1.1      INF  0.368
14      Michael Busch 21  2 0.111 0.286 0.248 0.335 0.440  2.3      INF  0.274
15       Mookie Betts 19 16 0.118 0.110 0.289 0.372 0.491  4.4       OF  0.229
16       Nico Hoerner  7 31 0.069 0.103 0.273 0.335 0.373  4.0      INF  0.352
17        Sal Frelick  2 18 0.074 0.149 0.259 0.320 0.335  1.6       OF  0.296
18     Salvador Perez 27  0 0.067 0.198 0.271 0.330 0.456  3.1        C  0.464
19       Seiya Suzuki 21 16 0.108 0.274 0.283 0.366 0.482  3.6       OF  0.236
20 Vinnie Pasquantino 19  1 0.072 0.128 0.262 0.315 0.446  1.5      INF  0.338
21        Yainer Diaz 16  2 0.039 0.173 0.299 0.325 0.441  3.0        C  0.457
22         Zack Gelof 17 25 0.069 0.344 0.211 0.270 0.362  1.4      INF  0.328
   ZSwing Contact  Zone SwStr        Cooks      StuRes       dffits  covratio
1   0.719   0.712 0.410 0.121 2.820855e-03 -0.26405370 -0.129603435 1.3006955
2   0.691   0.886 0.432 0.051 1.324954e-04 -0.09006203 -0.028081334 1.1526726
3   0.748   0.808 0.400 0.098 4.728948e-06 -0.01866809 -0.005305006 1.1356841
4   0.667   0.787 0.412 0.092 1.440188e-02 -2.43642682 -0.300091586 0.7918695
5   0.787   0.696 0.411 0.187 9.245912e-03 -0.67214577 -0.235004902 1.1534076
6   0.719   0.684 0.410 0.148 5.261083e-02 -2.18931670 -0.570783905 0.8818551
7   0.824   0.784 0.421 0.114 3.230305e-04  0.15159557  0.043849569 1.1374946
8   0.624   0.679 0.404 0.138 7.968706e-04  0.24103678  0.068881007 1.1334077
9   0.826   0.690 0.401 0.192 6.611364e-03  0.62328442  0.198671447 1.1356740
10  0.698   0.715 0.389 0.149 2.040312e-03 -0.40031327 -0.110264149 1.1216181
11  0.706   0.864 0.406 0.067 2.290098e-03 -0.33574779 -0.116796317 1.1717472
12  0.626   0.704 0.413 0.118 4.418437e-05  0.06246263  0.016216017 1.1213451
13  0.647   0.942 0.453 0.029 2.647594e-03 -0.34386893 -0.125584928 1.1844317
14  0.710   0.745 0.404 0.115 1.721517e-02  2.27140280  0.327011870 0.8283663
15  0.654   0.861 0.410 0.056 4.176453e-02 -2.38058717 -0.510445803 0.8263205
16  0.653   0.893 0.431 0.051 4.433211e-04  0.18658168  0.051371665 1.1285232
17  0.563   0.884 0.434 0.048 9.423523e-04 -0.25765448 -0.074907767 1.1359596
18  0.776   0.741 0.364 0.149 1.286440e-03 -0.29694890 -0.087529318 1.1372235
19  0.627   0.777 0.410 0.088 3.618640e-02  2.39026861  0.475230145 0.8194639
20  0.674   0.875 0.412 0.059 8.998308e-06  0.02866328  0.007317873 1.1191675
21  0.796   0.776 0.387 0.132 1.189688e-03  0.29800999  0.084173696 1.1297028
22  0.745   0.653 0.443 0.178 1.775137e-04 -0.10551230 -0.032504132 1.1500473</code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(mlb_3, <span class="fu">abs</span>(dffits) <span class="sc">&gt;</span> (<span class="dv">2</span><span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">5</span><span class="sc">/</span><span class="dv">129</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    Name HR SB    BB     K   AVG   OBP   SLG  WAR Position
1      Anthony Santander 44  2 0.087 0.194 0.235 0.308 0.506  3.3       OF
2           Brice Turang  7 50 0.081 0.170 0.254 0.316 0.349  2.5      INF
3           Bryce Harper 30  7 0.120 0.219 0.285 0.373 0.525  5.2      INF
4      Christopher Morel 21  8 0.100 0.260 0.196 0.288 0.346 -1.0      INF
5        George Springer 19 16 0.098 0.187 0.220 0.303 0.371  1.2       OF
6              Juan Soto 41  7 0.181 0.167 0.288 0.419 0.569  8.1       OF
7           Mookie Betts 19 16 0.118 0.110 0.289 0.372 0.491  4.4       OF
8         Nathaniel Lowe 16  2 0.126 0.221 0.265 0.361 0.401  2.8      INF
9           Rhys Hoskins 26  3 0.103 0.288 0.214 0.303 0.419  0.1      INF
10          Seiya Suzuki 21 16 0.108 0.274 0.283 0.366 0.482  3.6       OF
11         Shohei Ohtani 54 59 0.111 0.222 0.310 0.390 0.646  9.1       DH
12 Vladimir Guerrero Jr. 30  2 0.103 0.138 0.323 0.396 0.544  5.4      INF
   OSwing ZSwing Contact  Zone SwStr      Cooks    StuRes     dffits  covratio
1   0.375  0.688   0.822 0.392 0.088 0.03242748  1.257791  0.4421511 1.0912195
2   0.317  0.644   0.880 0.454 0.056 0.02698486  1.883713  0.4066489 0.9212363
3   0.366  0.805   0.751 0.368 0.131 0.02646009  1.556614  0.4007920 0.9930907
4   0.297  0.719   0.684 0.410 0.148 0.05261083 -2.189317 -0.5707839 0.8818551
5   0.284  0.753   0.769 0.440 0.113 0.03234752 -1.896058 -0.4453125 0.9264256
6   0.213  0.601   0.799 0.402 0.074 0.07717007 -2.026086 -0.6892841 0.9533154
7   0.229  0.654   0.861 0.410 0.056 0.04176453 -2.380587 -0.5104458 0.8263205
8   0.271  0.639   0.812 0.424 0.080 0.02709372  1.733701  0.4065459 0.9542884
9   0.281  0.615   0.771 0.439 0.098 0.03188314  1.865198  0.4418897 0.9327265
10  0.236  0.627   0.777 0.410 0.088 0.03618640  2.390269  0.4752301 0.8194639
11  0.305  0.705   0.735 0.418 0.125 0.02807253 -1.166090 -0.4110150 1.1041315
12  0.306  0.710   0.801 0.430 0.096 0.03198945 -1.879266 -0.4427234 0.9296988</code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>interact1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(K <span class="sc">~</span> OBP <span class="sc">+</span> SLG <span class="sc">+</span> OSwing <span class="sc">+</span> ZSwing <span class="sc">+</span> SwStr <span class="sc">+</span> SLG<span class="sc">:</span>ZSwing, <span class="at">data =</span> mlb3)</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(interact1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = K ~ OBP + SLG + OSwing + ZSwing + SwStr + SLG:ZSwing, 
    data = mlb3)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.048259 -0.012179 -0.000761  0.011466  0.051946 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  0.83637    0.17585   4.756 5.46e-06 ***
OBP         -0.43093    0.10753  -4.008 0.000106 ***
SLG         -0.67450    0.39131  -1.724 0.087298 .  
OSwing      -0.44470    0.04413 -10.076  &lt; 2e-16 ***
ZSwing      -0.84155    0.24455  -3.441 0.000794 ***
SwStr        1.95578    0.07944  24.618  &lt; 2e-16 ***
SLG:ZSwing   1.08865    0.55600   1.958 0.052511 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.01979 on 122 degrees of freedom
Multiple R-squared:  0.8671,    Adjusted R-squared:  0.8606 
F-statistic: 132.7 on 6 and 122 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># interact2 &lt;- lm(Kperc ~ OBP + SLG + OSwingperc + ZSwingperc + SwStrperc + SwStrperc:Position, mlb3)</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(interact2)</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a><span class="co"># interact3 &lt;- lm(Kperc ~ SwStrperc + SLG * ZSwingperc, data = mlb3)</span></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(interact3)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>First we looked at MLR model with every predictor to see how the model would fit. After that, we ran a best subsets regression to find the optimal model with the most optimal predictors. Based off that optimal model, we checked all of our assumptions and multicollinearity. After finding no issues we checked for influential points or outliers. Then we tested out some interaction terms to see if we could improve our model even more.</p>
</section>
<section id="testing-model" class="level2">
<h2 class="anchored" data-anchor-id="testing-model">Testing Model</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># mlb3 %&gt;% </span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># sample_n(8)</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>players_to_test <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Will Smith"</span>, <span class="st">"Isaac Paredes"</span>, <span class="st">"Francisco Lindor"</span>, <span class="st">"Corey Seager"</span>,</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"Brendan Rodgers"</span>, <span class="st">"Ryan McMahon"</span>, <span class="st">"Wyatt Langford"</span>, <span class="st">"Trea Turner"</span>)</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>test_data <span class="ot">&lt;-</span> mlb3 <span class="sc">%&gt;%</span></span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Name <span class="sc">%in%</span> players_to_test)</span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>test_data<span class="sc">$</span>predicted_K <span class="ot">&lt;-</span> <span class="fu">predict</span>(interact1, <span class="at">newdata =</span> test_data)</span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a>test_data <span class="sc">%&gt;%</span></span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Name, K, predicted_K)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              Name     K predicted_K
1  Brendan Rodgers 0.245   0.2257628
2     Corey Seager 0.180   0.1867490
3 Francisco Lindor 0.184   0.2041766
4    Isaac Paredes 0.164   0.1525343
5     Ryan McMahon 0.287   0.2729263
6      Trea Turner 0.182   0.2093556
7       Will Smith 0.193   0.1804150
8   Wyatt Langford 0.206   0.2123676</code></pre>
</div>
</div>
<p>We then tested the model on 8 randomly selected players which were randomly generated from the sample. Those players were Will Smith, Isaac Paredes, Francisco Lindor, Corey Seager, Brendan Rodgers, Ryan McMahon, Wyatt Langford and Trea Turner. Looking at the results between the predicted strikeout rate and the actual strikeout rate, all 8 players predicted strikeout rates were within 1.5% of their true strikeout rate on average.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>